# 토비의 스프링 3.1 - 오브젝트와 의존관계

스프링의 핵심은 객체 지향이며, 우리는 **오브젝트**에 집중한다.  
프로그램은 끊임없이 변화하는 존재이고, 그에 따라 우리는 변화에 유연하게 대응할 수 있는 프로그래밍을 해야 한다.  

즉, **분리와 확장이 가능한 구조**가 중요하다.  

---

## 객체와 의존관계
객체는 혼자 존재하지 않으며 서로 협력하며 기능을 완성하고, 이 과정에서 **의존관계**가 만들어진다.  

문제는, 객체가 다른 객체를 직접 생성하며 강하게 결합될 때 발생한다.  

```java
public class UserService {
    private UserDao userDao = new UserDao(); 
}
```

이 구조는 단순해 보이지만, `UserDao`의 구현이 바뀔 때마다 `UserService`의 코드도 바뀌어야 한다.  
즉, 변화에 취약한 코드가 된다.  

---

## 객체지향 설계 원칙
변화에 강한 구조를 만들려면 **객체지향 설계 원칙**을 따라야 한다.  

### SRP (단일 책임 원칙)
- 객체는 한 가지 책임에 집중해야 한다.  
- `UserService`는 비즈니스 로직만 담당하고, 객체 생성은 다른 책임으로 분리해야 한다.  

### OCP (개방-폐쇄 원칙)
- 확장에는 열려 있고, 변경에는 닫혀 있어야 한다.  
- 새로운 `UserDao` 구현체를 도입해도, `UserService`는 건드리지 않아야 한다.  

### DIP (의존 역전 원칙)
- 구체 클래스가 아니라 추상화(인터페이스)에 의존해야 한다.  
- 구현체가 달라져도 서비스는 유지되도록 한다.  

---

## IoC - 제어의 역전
전통적인 방식에서는 객체가 필요한 의존성을 스스로 만든다.  
하지만 IoC(Inversion of Control)는 이 흐름을 거꾸로 바꾼다.  

**객체는 단지 의존성을 받을 뿐, 제어권은 외부로 넘어간다.**  
이 “외부”의 역할을 하는 것이 바로 **스프링 컨테이너**이다.  

---

## DI - 의존성 주입
IoC의 한 구체적인 형태가 바로 **DI(Dependency Injection)** 이다.  

```java
public class UserService {
    private final UserDao userDao;

    public UserService(UserDao userDao) { 
        this.userDao = userDao;
    }
}
```

이제 `UserService`는 `UserDao`의 구체적인 구현을 알 필요가 없다.  
외부에서 어떤 구현체를 넣어주느냐에 따라 동작이 달라진다.  

---

## 스프링 컨테이너와 Bean
스프링은 DI를 지원하는 **IoC 컨테이너**이다.  
컨테이너는 객체를 대신 생성하고, 필요한 의존관계를 연결해준다.  

- **Bean** : 컨테이너가 관리하는 객체  
- **BeanFactory** : Bean을 생성하고 의존관계를 관리하는 최소 단위 컨테이너  
- **ApplicationContext** : BeanFactory를 확장한 컨테이너  

👉 실무에서는 대부분 `ApplicationContext`를 사용한다.  

---

## 설정

스프링 컨테이너가 객체를 관리하려면, **설정 정보**가 필요하다.  

### Java 설정
```java
@Configuration
public class AppConfig {
    @Bean
    public UserDao userDao() {
        return new JdbcUserDao();
    }

    @Bean
    public UserService userService() {
        return new UserService(userDao());
    }
}
```

### XML 설정
```xml
<beans>
    <bean id="userDao" class="com.example.JdbcUserDao"/>
    <bean id="userService" class="com.example.UserService">
        <constructor-arg ref="userDao"/>
    </bean>
</beans>
```

---

## ApplicationContext vs BeanFactory
- **BeanFactory** : 최소한의 DI 컨테이너 역할만 한다.  
- **ApplicationContext** : BeanFactory의 기능을 포함하고, 실제 애플리케이션 실행에 필요한 다양한 인프라를 제공한다.  

👉 정리하자면,  
- `BeanFactory` = 단순한 객체 팩토리  
- `ApplicationContext` = 스프링 핵심 컨테이너  

---

## 결론
스프링이 강조하는 바는 단순한 **편리함**이 아니다.  

- 객체는 서로 협력하면서도 느슨하게 결합해야 하고,  
- 변화에 열려 있으면서도 안정적으로 유지되어야 한다.  

**IoC/DI는 이를 가능하게 하는 핵심 원리이며, 스프링은 이를 지원하는 강력한 도구이다.**  

즉, **스프링은 오브젝트와 의존관계의 문제를 해결하기 위해 존재한다.**  
